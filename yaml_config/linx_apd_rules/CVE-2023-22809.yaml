- rule: Detect CVE-2023-22809 via sudoedit with '--'
  desc: Detects exploitation of CVE-2023-22809 by detecting use of '--' in EDITOR/SUDO_EDITOR environment variable.
  condition: >
    proc.name = "sudoedit"
    and evt.type = execve
    and evt.arg.env contains "--"
  output: >
    CVE-2023-22809 exploit attempt detected via sudoedit (pid=%proc.pid ppid=%proc.ppid user=%user.name command=%proc.cmdline env=%evt.arg.env)
  priority: EMERGENCY
  tags:
    - vulnerability
    - cve
    - cve-2023-22809
    - privilege_escalation
  chdesc: Sudo权限提升
  operation:
    kind: exec
    params: 
      - kill -9 %proc.ppid
      - proc.ppid
  notify:
    title: CVE漏洞利用
    content: 检测到针对漏洞CVE-2023-22809的利用
